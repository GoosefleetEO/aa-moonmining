{% extends 'allianceauth/base.html' %}
{% load i18n %}
{% block page_title %}{% trans 'Moon List' %}{% endblock %}
{% load static %}

{% block content %}
    <div class="col-lg-12">
        <br>
        {% include 'moonstuff/moonmenu.html' %}
        <h2> {% trans "Moons" %} </h2>
        <p class="lead">Only moons that have had extractions or have been scanned will be listed.</p>
        
        <div id="loader">
			<img class="center-block" src="{% static "moonstuff/Spinner-1s-200px.svg" %}" alt="Spinner"/>
		</div>
        
        <div id="moon_table" style="display: none !important;">
            <table class="table table-striped" id="moon-list" style="width:100%;">
                <thead>
                    <th>Moon</th>
                    <th>System</th>
                    <th>Region</th>
                    <th>Details</th>
                </thead>
                <tbody>                   
                </tbody>
            </table>
        </div>
    </div>


{% endblock %}
{% block extra_javascript %}
    {% include 'bundles/datatables-js.html' %}
    <!--load JS for filterDropDown plugin -->
    <script 
        type="text/javascript" 
        src="{% static "moonstuff/filterDropDown.min.js" %}">
    </script>
{% endblock %}
{% block extra_css %}
    {% include 'bundles/datatables-css.html' %}

    <link 
        href="{% static "moonstuff/moonstuff.css" %}" 
        type="text/css" 
        rel="stylesheet"
    >
{% endblock %}
{% block extra_script %}
    $(function(){
        /* datatable definition */
        var table = $('#moon-list').DataTable({
            ajax: {
                url: '{{ ajax_url }}',                
                dataSrc: '',
                cache: true
            },	

            columns: [																			
                { data: 'moon_name' },
                { data: 'solar_system_link' },
                { data: 'region_name' },
                { data: 'details' },

                { data: 'solar_system_name' },                
            ],

            lengthMenu: [[8, 15, 25, 50, -1], [8, 15, 25, 50, "All"]],

            order: [ [0, "asc"] ],

            columnDefs: [														
                { "orderable": false, "targets": [ 3 ] },
                { "visible": false, "targets": [ 4 ] },
            ],
      
            filterDropDown: {										
                columns: [																
                    { 
                        idx: 4,
                        title: "System"
                    },
                    { 
                        idx: 2
                    }
                ],
                bootstrap: true,
                autoSize: false
            },
            
        });

        /* show table after loading from AJAX source is complete */
        table.on( 'xhr', function () {						
            table.columns.adjust().draw();
            $("#loader").hide();
            $("#moon_table").show();
        } );
    });
{% endblock %}